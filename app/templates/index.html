{% extends "base.html" %}

{% block content %}
<section class="featured-posts">
    <h2 class="section-title">Featured Stories</h2>
    <div class="post-grid">
        {% for post in posts %}
        <article class="post-card">
            <div class="post-card-content">
                <h3><a href="{{ url_for('content', slug=post.slug) }}">{{ post.title }}</a></h3>
                <div class="post-meta">
                    <i class="fas fa-calendar"></i>
                    <span>Posted on {{ post.timestamp.strftime('%Y-%m-%d') }}</span>
                </div>
                <div class="post-excerpt">
                    {{ post.content_html|safe|truncate(200) }}
                </div>
                <div class="post-actions">
                        <a href="{{ url_for('content', slug=post.slug) }}" class="btn btn-sm btn-primary"><i
                            class="fas fa-eye"></i>View</a>
                        <a href="{{ url_for('edit', id=post.id) }}" class="btn btn-sm btn-secondary"><i
                            class="fas fa-edit"></i>Edit</a>
                        <form method="POST" action="{{ url_for('delete', id=post.id) }}" class="delete-form">
                                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
                        <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure?')"><i
                                class="fas fa-trash"></i>Delete</button>
                           
                    </form>
                </div>
            </div>
        </article>
        {% endfor %}
    </div>
</section>

<section class="categories">
    <h2 class="section-title">Explore</h2>
    <div class="category-links">
        {% set categories = [
        ('countryside', 'Countryside', 'fa-mountain'),
        ('durian-orchard', 'Durian Orchard', 'fa-seedling'),
        ('local-people', 'Local People', 'fa-users')
        ] %}

        {% for cat_slug, cat_name, cat_icon in categories %}
        {% set cat_posts = posts|selectattr('category', 'equalto', cat_slug)|list %}
        <a href="{{ url_for('category', category=cat_slug) }}"
            class="category-link {% if cat_posts %}has-posts{% else %}no-posts{% endif %}">
            <i class="fas {{ cat_icon }}"></i>{{ cat_name }}
            {% if cat_posts %}
            <span class="post-count">{{ cat_posts|length }}</span>
            {% endif %}
        </a>
        {% endfor %}
    </div>
</section>
{% endblock %}